<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Générateur de Rendu Imprimable</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Library for reading and exporting Excel files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .file-drop-area {
            transition: all 0.2s ease-in-out;
        }

        .file-drop-area.dragover {
            background-color: #e0f2fe;
            border-color: #3b82f6;
        }

        /* Status styles for drop zones */
        .file-drop-area.success {
            background-color: #f0fdf4; /* green-50 */
            border-color: #4ade80;   /* green-400 */
        }
        .file-drop-area.error {
            background-color: #fef2f2; /* red-50 */
            border-color: #f87171;   /* red-400 */
        }

        /* Sorting styles */
        th[data-column] {
            cursor: pointer;
            position: relative;
        }

        th[data-column]:hover {
            background-color: #e2e8f0;
        }

        .sort-indicator {
            display: inline-block;
            width: 1em;
            height: 1em;
            text-align: right;
            font-size: 0.8em;
            margin-left: 4px;
            color: #64748b;
        }

        th.sorted .sort-indicator {
            color: #0f172a;
        }


        @media print {
            body * {
                visibility: hidden;
            }

            #print-section,
            #print-section * {
                visibility: visible;
            }

            #print-section {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }

            table {
                font-size: 8px; /* Reduce font size for printing */
                width: 100%;
                table-layout: fixed;
            }

            th, td {
                padding: 4px;
            }
            .sort-indicator, .action-buttons {
                display: none;
            }
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-800">
    <div class="min-h-screen flex flex-col items-center py-8 px-4">

        <!-- Input Section -->
        <div id="input-section" class="w-full max-w-4xl bg-white p-6 md:p-8 rounded-2xl shadow-lg">
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Residents File Input -->
                <div class="flex flex-col">
                    <label for="residentsFile" class="mb-2 font-semibold text-slate-700">1. Fichier des Résidents (.xlsx, .csv)</label>
                    <div id="drop-zone-residents" class="file-drop-area border-2 border-dashed border-slate-300 rounded-lg p-4 text-center cursor-pointer">
                        <input type="file" id="residentsFile" accept=".csv,.xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel" class="hidden">
                        <svg class="mx-auto h-10 w-10 text-slate-400" stroke="currentColor" fill="none" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
                        </svg>
                        <p class="mt-2 text-sm text-slate-500"><span class="font-semibold text-blue-600">Choisissez un fichier</span> ou glissez-déposez</p>
                        <p id="residents-file-status" class="text-xs text-slate-500 mt-1 truncate"></p>
                    </div>
                </div>

                <!-- Evaluations File Input -->
                <div class="flex flex-col">
                    <label for="evaluationsFile" class="mb-2 font-semibold text-slate-700">2. Fichier des Évaluations (.xlsx, .csv)</label>
                    <div id="drop-zone-evaluations" class="file-drop-area border-2 border-dashed border-slate-300 rounded-lg p-4 text-center cursor-pointer">
                        <input type="file" id="evaluationsFile" accept=".csv,.xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel" class="hidden">
                        <svg class="mx-auto h-10 w-10 text-slate-400" stroke="currentColor" fill="none" viewBox="0 0 24 24" aria-hidden="true">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <p class="mt-2 text-sm text-slate-500"><span class="font-semibold text-blue-600">Choisissez un fichier</span> ou glissez-déposez</p>
                        <p id="evaluations-file-status" class="text-xs text-slate-500 mt-1 truncate"></p>
                    </div>
                </div>
            </div>

            <div class="mt-8 text-center">
                <button id="generateBtn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-blue-700 transition-transform transform hover:scale-105 disabled:bg-slate-400 disabled:cursor-not-allowed disabled:scale-100" disabled>
                    Générer le rapport
                </button>
            </div>
            <p id="error-message" class="text-red-500 text-center mt-4 text-sm font-medium"></p>
        </div>

        <!-- Output Section -->
        <div id="output-section" class="w-full max-w-full mt-10 hidden">
            <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-slate-900">Rapport Généré</h2>
                    <div class="action-buttons flex gap-3">
                         <button id="exportBtn" class="bg-teal-600 text-white font-bold py-2 px-6 rounded-lg shadow-md hover:bg-teal-700 transition-transform transform hover:scale-105 flex items-center gap-2">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg>
                            Exporter
                        </button>
                        <button id="printBtn" class="bg-green-600 text-white font-bold py-2 px-6 rounded-lg shadow-md hover:bg-green-700 transition-transform transform hover:scale-105 flex items-center gap-2">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clip-rule="evenodd"></path></svg>
                            Imprimer
                        </button>
                    </div>
                </div>
                <div id="print-section" class="overflow-x-auto">
                    <div id="output-table-container"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const residentsFileInput = document.getElementById('residentsFile');
        const evaluationsFileInput = document.getElementById('evaluationsFile');
        const generateBtn = document.getElementById('generateBtn');
        const printBtn = document.getElementById('printBtn');
        const exportBtn = document.getElementById('exportBtn');
        const outputSection = document.getElementById('output-section');
        const outputTableContainer = document.getElementById('output-table-container');
        const errorMessage = document.getElementById('error-message');
        const dropZoneResidents = document.getElementById('drop-zone-residents');
        const dropZoneEvaluations = document.getElementById('drop-zone-evaluations');
        const residentsFileStatus = document.getElementById('residents-file-status');
        const evaluationsFileStatus = document.getElementById('evaluations-file-status');

        // --- State ---
        let processedData = [];
        let residentsDataCache = null;
        let evaluationsDataCache = null;
        let currentSort = { column: null, direction: 'asc' };

        // --- Drag & Drop Setup ---
        function setupDropZone(dropZone, fileInput, statusElement, fileType) {
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, e => { e.preventDefault(); e.stopPropagation(); }, false);
            });
            ['dragenter', 'dragover'].forEach(eventName => dropZone.addEventListener(eventName, () => dropZone.classList.add('dragover'), false));
            ['dragleave', 'drop'].forEach(eventName => dropZone.addEventListener(eventName, () => dropZone.classList.remove('dragover'), false));

            dropZone.addEventListener('click', () => fileInput.click());
            dropZone.addEventListener('drop', e => {
                fileInput.files = e.dataTransfer.files;
                handleFileSelect(fileInput, dropZone, statusElement, fileType);
            }, false);
            fileInput.addEventListener('change', () => handleFileSelect(fileInput, dropZone, statusElement, fileType));
        }

        setupDropZone(dropZoneResidents, residentsFileInput, residentsFileStatus, 'residents');
        setupDropZone(dropZoneEvaluations, evaluationsFileInput, evaluationsFileStatus, 'evaluations');

        function checkAllFilesLoaded() {
            generateBtn.disabled = !(residentsDataCache && evaluationsDataCache);
        }

        async function handleFileSelect(input, dropZone, statusEl, fileType) {
            const file = input.files[0];
            if (!file) return;

            statusEl.textContent = `Lecture de "${file.name}"...`;
            dropZone.classList.remove('success', 'error');

            try {
                const data = await processFile(file);
                if (fileType === 'residents') {
                    residentsDataCache = data;
                } else {
                    evaluationsDataCache = data;
                }
                dropZone.classList.add('success');
                statusEl.textContent = `${data.length} lignes lues depuis "${file.name}"`;
            } catch (error) {
                 if (fileType === 'residents') residentsDataCache = null;
                 else evaluationsDataCache = null;
                dropZone.classList.add('error');
                statusEl.textContent = `Erreur: impossible de lire "${file.name}"`;
                console.error("File processing error:", error);
            }
            checkAllFilesLoaded();
        }

        // --- File Processing ---
        async function processFile(file) {
             return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const data = event.target.result;
                        let jsonData;
                        if (file.name.endsWith('.xlsx')) {
                            const workbook = XLSX.read(data, { type: 'array', cellDates: true });
                            jsonData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
                        } else {
                             const text = new TextDecoder('iso-8859-1').decode(data);
                             const rows = text.split('\n').filter(row => row.trim());
                             if (rows.length < 2) return resolve([]);
                             const header = rows[0].split(',').map(h => h.trim().replace(/"/g, ''));
                             jsonData = rows.slice(1).map(row => {
                                 const values = row.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g) || [];
                                 return header.reduce((obj, key, i) => ({ ...obj, [key]: (values[i] || '').trim().replace(/"/g, '') }), {});
                             });
                        }
                        resolve(jsonData);
                    } catch (err) { reject(err); }
                };
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }

        // --- Data Normalization & Interpretation ---
        const formatDate = (date) => date instanceof Date ? `${String(date.getDate()).padStart(2, '0')}/${String(date.getMonth() + 1).padStart(2, '0')}/${date.getFullYear()}` : (date || '');
        const normalizeResidentName = (name) => typeof name !== 'string' ? '' : name.replace(/\s*\n\s*/g, ' ').replace(/^(Mme\.|M\.|Monsieur|Madame)\s*/, '').split(' Née ')[0].split(' (')[0].trim();
        const getMmseInterpretation = (scoreStr) => { /* ... (unchanged) ... */ };
        const getGdsInterpretation = (scoreStr) => { /* ... (unchanged) ... */ };

        // --- Sorting Logic ---
        function sortData(column) {
            const newDirection = (currentSort.column === column && currentSort.direction === 'asc') ? 'desc' : 'asc';
            currentSort = { column, direction: newDirection };
            const collator = new Intl.Collator('fr', { numeric: true, sensitivity: 'base' });

            processedData.sort((a, b) => {
                let valA, valB;

                if (column.endsWith('Date')) {
                    const type = column.replace('Date', '');
                    valA = a.evals[type]?.dateObj;
                    valB = b.evals[type]?.dateObj;
                } else if (column.endsWith('Score')) {
                    const type = column.replace('Score', '');
                    valA = a.evals[type]?.sortResult;
                    valB = b.evals[type]?.sortResult;
                } else {
                    valA = a[column];
                    valB = b[column];
                }

                if (valA === null || valA === undefined) return 1;
                if (valB === null || valB === undefined) return -1;

                let comparison;
                if (valA instanceof Date && valB instanceof Date) {
                    comparison = valA.getTime() - valB.getTime();
                } else if (typeof valA === 'number' && typeof valB === 'number') {
                    comparison = valA - valB;
                } else {
                    comparison = collator.compare(String(valA), String(valB));
                }

                return currentSort.direction === 'asc' ? comparison : -comparison;
            });
            renderTable();
        }

        // --- Rendering ---
        function renderTable() {
            let tableHtml = `
                <table class="min-w-full bg-white border border-slate-200">
                    <thead class="bg-slate-100 sticky top-0">
                        <tr>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="N° de chambre">Ch.<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="fullName">Nom Prénom<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="Âge">Age<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="birthDate">Naissance<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="Entrée">Entrée<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="GIR">GIR<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="MMSEDate">MMSE Date<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="MMSEScore">MMSE Score<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="GDSDate">GDS Date<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="GDSScore">GDS Score<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="RUDDate">RUD Date<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="RUDScore">RUD Score<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="NPIESDate">NPI-ES Date<span class="sort-indicator"></span></th>
                            <th class="py-2 px-3 border-b text-left text-xs font-semibold text-slate-600 uppercase tracking-wider" data-column="NPIESScore">NPI-ES Score<span class="sort-indicator"></span></th>
                        </tr>
                    </thead>
                    <tbody>`;

            processedData.forEach((resident, index) => {
                const { evals } = resident;
                tableHtml += `
                    <tr class="${index % 2 === 0 ? 'bg-white' : 'bg-slate-50'} hover:bg-blue-50">
                        <td class="py-2 px-3 border-b border-slate-200 text-sm">${resident['N° de chambre'] || ''}</td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm font-medium">${resident.fullName || ''}</td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm">${resident['Âge'] || ''}</td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm">${formatDate(resident.birthDate)}</td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm">${formatDate(resident['Entrée'])}</td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm">${resident['GIR'] || ''}</td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm">${evals.MMSE ? evals.MMSE.date : 'N/A'}</td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm"><b>${evals.MMSE ? evals.MMSE.result : 'N/A'}</b></td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm">${evals.GDS ? evals.GDS.date : 'N/A'}</td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm"><b>${evals.GDS ? evals.GDS.result : 'N/A'}</b></td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm">${evals.RUD ? evals.RUD.date : 'N/A'}</td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm"><b>${evals.RUD ? evals.RUD.result : 'N/A'}</b></td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm">${evals.NPIES ? evals.NPIES.date : 'N/A'}</td>
                        <td class="py-2 px-3 border-b border-slate-200 text-sm"><b>${evals.NPIES ? evals.NPIES.result : 'N/A'}</b></td>
                    </tr>`;
            });
            tableHtml += '</tbody></table>';
            outputTableContainer.innerHTML = tableHtml;

            // Update sort indicators and add event listeners
            document.querySelectorAll('th[data-column]').forEach(th => {
                th.classList.remove('sorted');
                const indicator = th.querySelector('.sort-indicator');
                if(indicator) indicator.textContent = '';
                if (th.dataset.column === currentSort.column) {
                    th.classList.add('sorted');
                    if(indicator) indicator.textContent = currentSort.direction === 'asc' ? '▲' : '▼';
                }
                th.onclick = () => sortData(th.dataset.column);
            });
        }

        // --- Main Generation Logic ---
        generateBtn.addEventListener('click', async () => {
            if (!residentsDataCache || !evaluationsDataCache) {
                errorMessage.textContent = 'Veuillez charger les deux fichiers valides.';
                return;
            }
            errorMessage.textContent = '';
            generateBtn.disabled = true;
            generateBtn.textContent = 'Génération en cours...';

            try {
                // Data is already loaded, just process it
                const residentEvals = {};
                evaluationsDataCache.forEach(ev => {
                    const normalizedName = normalizeResidentName(ev['Résident']);
                    if (!normalizedName) return;
                    if (!residentEvals[normalizedName]) residentEvals[normalizedName] = {};
                    let evDate;
                    if (ev['Date'] instanceof Date) { evDate = ev['Date']; }
                    else if (typeof ev['Date'] === 'string' && ev['Date'].includes('à')) {
                       const parts = ev['Date'].split(' à ');
                       const dateParts = parts[0].split('/');
                       if (dateParts.length === 3) evDate = new Date(dateParts[2], dateParts[1] - 1, dateParts[0]);
                    }
                    if (!evDate) return;

                    let typeKey = ['MMSE', 'GDS', 'RUD', 'NPI-ES'].find(k => ev['Type'].includes(k.replace('NPI-ES', 'NPIES')));
                    if(typeKey === 'NPI-ES') typeKey = 'NPIES';

                    const resultRaw = ev['Résultat'];
                    let displayResult, sortResult;

                    if (typeof resultRaw === 'string' && /non[^\w]*[eé]valuable/i.test(resultRaw)) {
                        displayResult = 'NE';
                        sortResult = 9999;
                    } else {
                        const numericMatch = String(resultRaw).match(/\d+/);
                        if (numericMatch) {
                            displayResult = numericMatch[0];
                            sortResult = parseInt(numericMatch[0], 10);
                        } else {
                            displayResult = resultRaw || 'N/A';
                            sortResult = null;
                        }
                    }

                    if (typeKey) {
                         const existing = residentEvals[normalizedName][typeKey];
                         if (!existing || evDate > existing.dateObj) {
                            residentEvals[normalizedName][typeKey] = {
                                date: formatDate(evDate),
                                dateObj: evDate,
                                result: displayResult,
                                sortResult: sortResult
                            };
                        }
                    }
                });

                processedData = residentsDataCache.map(r => {
                    const normalizedName = normalizeResidentName(r['Résident']);
                    const evals = residentEvals[normalizedName] || {};
                    return {
                        'fullName': r['Résident'],'normalizedName': normalizedName,'N° de chambre': r['N° de chambre'],
                        'Âge': r['Âge'],'birthDate': r['Date naissance'],'Entrée': r['Dernière entrée'] || r['Entrée'],
                        'GIR': r['GIR'], evals
                    };
                });

                currentSort.column = 'N° de chambre'; currentSort.direction = 'asc';
                sortData(currentSort.column);
                outputSection.classList.remove('hidden');

            } catch (error) {
                console.error('Error processing files:', error);
                errorMessage.textContent = 'Une erreur est survenue lors de la combinaison des données.';
            } finally {
                generateBtn.disabled = false;
                generateBtn.textContent = 'Générer le rapport';
            }
        });

        // --- Action Buttons ---
        printBtn.addEventListener('click', () => window.print());

        exportBtn.addEventListener('click', () => {
            if (processedData.length === 0) return;
            const dataToExport = processedData.map(row => ({
                'Ch.': row['N° de chambre'],
                'Nom Prénom': row.fullName,
                'Age': row['Âge'],
                'Naissance': formatDate(row.birthDate),
                'Entrée': formatDate(row['Entrée']),
                'GIR': row.GIR,
                'MMSE Résultat': row.evals.MMSE?.result,
                'MMSE Date': row.evals.MMSE?.date,
                'GDS Résultat': row.evals.GDS?.result,
                'GDS Date': row.evals.GDS?.date,
                'RUD Résultat': row.evals.RUD?.result,
                'RUD Date': row.evals.RUD?.date,
                'NPI-ES Résultat': row.evals.NPIES?.result,
                'NPI-ES Date': row.evals.NPIES?.date
            }));
            const worksheet = XLSX.utils.json_to_sheet(dataToExport);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Rapport");
            XLSX.writeFile(workbook, "Rapport_Résidents.xlsx");
        });

        // --- Full Implementation of Interpretation functions ---
        Object.assign(window, { getMmseInterpretation, getGdsInterpretation });
        const originalGetMmse = getMmseInterpretation;
        window.getMmseInterpretation = (scoreStr) => {
            const score = parseInt(scoreStr, 10);
            if (isNaN(score)) return { interpretation: scoreStr || "N/A", risk: "Inconnu" };
            if (score <= 10) return { interpretation: "Suspicion d'un syndrome démentiel sévère.", risk: "Démence" };
            if (score <= 18) return { interpretation: "Suspicion d'un syndrome démentiel modéré.", risk: "Démence" };
            if (score <= 24) return { interpretation: "Suspicion d'un syndrome démentiel léger.", risk: "Démence" };
            return { interpretation: "Absence de trouble cognitif.", risk: null };
        };
        const originalGetGds = getGdsInterpretation;
        window.getGdsInterpretation = (scoreStr) => {
            const score = parseInt(scoreStr, 10);
            if (isNaN(score)) return { interpretation: scoreStr || "N/A", risk: "Inconnu" };
            if (score >= 10) return { interpretation: "Très forte probabilité de dépression.", risk: "Dépression" };
            if (score >= 5) return { interpretation: "Forte probabilité de dépression.", risk: "Dépression" };
            return { interpretation: "Aucun risque de dépression.", risk: null };
        };


    </script>
</body>
</html>
